开发约束（当前阶段：组件化重构穿刺模式）

目标：优先推进“彻底组件化”重构，避免因为流程约束阻碍持续推进。

节奏与检查点（强制写明进度，防止“口头完成”）：
阶段 A：组件树与生命周期拆分
- 完成 Root → Frame/Overlay/Chat 的组件树搭建
- 删除/停用统一的 `layout_base/update_base/event_base` 路径
- 每个 widget 拥有独立 layout/update/event/render 实现

阶段 B：数据与组件绑定
- 引入 WidgetState / WidgetStore（或等价机制）
- 组件不得直接读写 TabState（只能通过绑定层）
- 明确 UI 状态归属：输入/滚动/选中/overlay 等归属具体组件

阶段 C：行为对齐与收尾
- 旧路径彻底移除
- 生命周期责任边界明确（layout/update/event/渲染）
- 组件级 smoke 测试能跑（只要求关键路径可验证）

当前阶段规则（临时覆盖）：
1) 允许跳过 `just install`、`cargo clippy`、测试与覆盖率要求。
2) 允许函数长度/文件行数在重构期间暂时超限，后续统一收敛。
3) 允许测试失败；以持续推进为首要目标。
4) 发生构建或运行问题时，不要求立即修复，可先记录并继续推进。

阶段结束条件（完成彻底组件化后恢复严格约束）：
- 所有 UI 与生命周期逻辑完全组件化；
- 数据与组件绑定完成；
- 组件树与生命周期职责清晰可验证。

完成上述条件后，恢复严格约束：
1) 每次改动代码后必须执行 `just install`。
2) 安装或运行问题必须定位修复后再交付。
3) 单个 Rust 源文件 > 300 行必须拆分。
4) 测试覆盖率 ≥ 80%。
5) 所有函数 ≤ 30 行。
6) 必须通过 `cargo clippy --all-targets --all-features` 且无警告，不允许 `#[allow(clippy::...)]`。
